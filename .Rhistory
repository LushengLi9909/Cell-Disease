require(visNetwork)
all_results_merged_mpo <- readRDS("data/all_mpo_results_merged.rds")
Disease_Gene <- read.delim("data/Disease_Gene.txt",header = TRUE,sep=",")
all_results <- merge(all_results_merged_mpo, Disease_Gene, by = "Phenotype", all.x = T)
all_results = all_results[!duplicated(all_results),]
all_results <- na.omit(all_results)
signif_results = all_results[all_results$q <= 0.05 , ]
adjacency = data.frame()
phenotype = "neurodegeneration"
for( c in unique(signif_results[signif_results$Phenotype == phenotype , "CellType"])){
adjacency = rbind(adjacency,data.frame("from"=phenotype,"to"=c))
}
for( d in unique(signif_results[signif_results$Phenotype == phenotype , "DO.Disease"])){
adjacency = rbind(adjacency,data.frame("from"=d,"to"=phenotype))
}
Npheno = length(phenotype)
Ncell = length(unique(signif_results[signif_results$Phenotype == phenotype , "CellType"]))
Ndo = length(unique(signif_results[signif_results$Phenotype == phenotype , "DO.Disease"]))
nodes <- data.frame( id=c(phenotype,unique(signif_results[signif_results$Phenotype == phenotype , "CellType"]),
unique(signif_results[signif_results$Phenotype == phenotype , "DO.Disease"])),
label=c(phenotype,unique(signif_results[signif_results$Phenotype == phenotype , "CellType"]),
unique(signif_results[signif_results$Phenotype == phenotype , "DO.Disease"])),
#value =c(as.numeric(phenos_lev$ontlvl),rep(0,Ncell)),
shape=c(rep("box",Npheno),rep("ellipse",Ncell),rep("box",Ndo)),
color=c(rep("lightblue",Npheno),rep("orange",Ncell),rep("red",Ndo)))
edges <- data.frame(from = c(adjacency$from),to = c(adjacency$to),arrows = c("to"))
visNetwork(nodes, edges)
View(Disease_Gene)
View(all_results_merged_mpo)
View(all_results_merged_mpo)
View(all_results)
write.table(signif_results, file = "signif_results.txt",sep=",",row.names = FALSE)
signif_results1 <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
View(signif_results1)
View(signif_results)
View(adjacency)
View(signif_results)
pheno = "neurodegeneration"
DF =  signif_results[signif_results$Phenotype == pheno , ]
View(DF)
adjacency = data.frame()
for( c in unique(signif_results[signif_results$Phenotype == phenotype , "CellType"])){
adjacency = rbind(adjacency,data.frame("from"=phenotype,"to"=c))
}
View(adjacency)
for( d in unique(signif_results[signif_results$Phenotype == phenotype , "DO.Disease"])){
adjacency = rbind(adjacency,data.frame("from"=d,"to"=phenotype))
}
View(adjacency)
View(nodes)
results = table_cell_do(pheno)
#abnormal alpha-beta T cell morphology
#pheno = "neurodegeneration"
table_cell_do = function(pheno){
if(pheno != ""){
DF =  signif_results[signif_results$Phenotype == pheno , ]
return(DF)
}
}
results = table_cell_do(pheno)
unique(results[, "CellType"])
unique(results[, "DO.Disease"])
View(nodes)
unique(results[, "CellType"])
adjacency = data.frame()
results = table_cell_do(pheno)
for( c in unique(results[, "CellType"])){
adjacency = rbind(adjacency,data.frame("from"=phenotype,"to"=c))
}
for( d in unique(results[, "DO.Disease"])){
adjacency = rbind(adjacency,data.frame("from"=d,"to"=phenotype))
}
Npheno = length(phenotype)
Ncell = length(unique(results[, "CellType"]))
Ndo = length(unique(results[, "DO.Disease"]))
nodes <- data.frame( id=c(pheno,unique(results[, "CellType"]),
unique(results[, "DO.Disease"])),
label=c(pheno,unique(results[, "CellType"]),
unique(results[, "DO.Disease"])),
shape=c(rep("box",Npheno),rep("ellipse",Ncell),rep("box",Ndo)),
color=c(rep("lightblue",Npheno),rep("orange",Ncell),rep("red",Ndo)))
edges <- data.frame(from = c(adjacency$from),to = c(adjacency$to),arrows = c("to"))
visNetwork(nodes, edges)
View(signif_results1)
View(signif_results)
pheno = "pulmonary emphysema"
results = table_cell_do(pheno)
DF =  signif_results[signif_results$DO.Disease == pheno , ]
View(DF)
results = DF
View(results)
unique(results[, "Phenotype"])
adjacency = data.frame()
for( p in unique(results[, "Phenotype"])){
adjacency = rbind(adjacency,data.frame("from"=pheno,"to"=p))
}
View(adjacency)
View(results)
adjacency = data.frame()
for( p in unique(results[, "Phenotype"])){
adjacency = rbind(adjacency,data.frame("from"=pheno,"to"=p))
for( c in unique(results[results$Phenotype == p, "CellType"])){
adjacency = rbind(adjacency,data.frame("from"=p,"to"=c))
}
}
View(adjacency)
nodes <- data.frame( id=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
label=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
shape=c(rep("box",Npheno),rep("box",NPhenos),rep("ellipse",Ncell)),
color=c(rep("red",Npheno),rep("lightblue",NPhenos),rep("orange",Ndo)))
NPhenos = length(unique(results[, "Phenotype"]))
nodes <- data.frame( id=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
label=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
shape=c(rep("box",Npheno),rep("box",NPhenos),rep("ellipse",Ncell)),
color=c(rep("red",Npheno),rep("lightblue",NPhenos),rep("orange",Ndo)))
pheno
unique(results[, "Phenotype"])
unique(results[, "CellType"])
Npheno
Npheno = length(pheno)
Ncell = length(unique(results[, "CellType"]))
Ndo = length(unique(results[, "DO.Disease"]))
NPhenos = length(unique(results[, "Phenotype"]))
nodes <- data.frame( id=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
label=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
shape=c(rep("box",Npheno),rep("box",NPhenos),rep("ellipse",Ncell)),
color=c(rep("red",Npheno),rep("lightblue",NPhenos),rep("orange",Ndo)))
Npheno
NPhenos
Ncell
nodes <- data.frame( id=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
label=c(pheno,unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
shape=c(rep("box",Npheno),rep("box",NPhenos),rep("ellipse",Ncell)),
color=c(rep("red",Npheno),rep("lightblue",NPhenos),rep("orange",Ncell)))
edges <- data.frame(from = c(adjacency$from),to = c(adjacency$to),arrows = c("to"))
visNetwork(nodes, edges)
adjacency = data.frame()
for( p in unique(results[, "Phenotype"])){
for( c in unique(results[results$Phenotype == p, "CellType"])){
adjacency = rbind(adjacency,data.frame("from"=p,"to"=c))
}
}
nodes <- data.frame( id=c(unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
label=c(unique(results[, "Phenotype"]),
unique(results[, "CellType"])),
shape=c(rep("box",NPhenos),rep("ellipse",Ncell)),
color=c(rep("lightblue",NPhenos),rep("orange",Ncell)))
edges <- data.frame(from = c(adjacency$from),to = c(adjacency$to),arrows = c("to"))
visNetwork(nodes, edges)
signif_results <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
#abnormal alpha-beta T cell morphology
#pheno = "neurodegeneration"
table_cell_do = function(pheno,type){
if(pheno != ""){
if(type = "1"){
DF =  signif_results[signif_results$Phenotype == pheno , ]
return(DF)}
} else {
DF =  signif_results[signif_results$DO.Disease == pheno , ]
return(DF)
}
}
View(signif_results)
signif_results[signif_results$DO.Disease = "agenesis of the corpus callosum with peripheral neuropathy",]
signif_results[signif_results$DO.Disease == "agenesis of the corpus callosum with peripheral neuropathy",]
unique(signif_results[signif_results$DO.Disease == "agenesis of the corpus callosum with peripheral neuropathy",]$CellType)
return(DF)}
ctd <- readRDS("data/TabulaMuris_n.rds")
View(ctd)
cell_order = factor(ctd[[1]]$plotting$cell_ordering,levels = ctd[[1]]$plotting$cell_ordering)
cell_order
write.table(cell_order, file = "cell_order.txt",sep=",",row.names = FALSE)
cell <- read.delim("cell_order.txt",header = TRUE,sep=",")
View(cell)
cell
cell$x
pheno = "progressive myoclonus epilepsy"
signif_results <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
results = signif_results[signif_results$DO.Disease == pheno , ]
do_signif_counts = data.frame()
for (c in unique(results$CellType)) {
n_signif = length(results[results$CellType == c, ]$q)
do_signif_counts = rbind(do_signif_counts,
data.frame("Do"=do,
"CellType"=c,
"n_signif"=n_signif))
}
do_signif_counts = data.frame()
for (c in unique(results$CellType)) {
n_signif = length(results[results$CellType == c, ]$q)
do_signif_counts = rbind(do_signif_counts,
data.frame("Do"=pheno,
"CellType"=c,
"n_signif"=n_signif))
}
View(do_signif_counts)
do_signif_counts$CellType = factor(do_signif_counts$CellType,levels = cell_order)
do_signif_counts$CellType
cell$x
do_signif_counts$CellType = factor(do_signif_counts$CellType,levels = cell$x)
do_signif_counts$CellType
levels(do_signif_counts$CellType)
signif_results <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
View(signif_results)
c(signif_results$Phenotype,signif_results$DO.Disease)
c(unique(signif_results$Phenotype),unique(signif_results$DO.Disease))
signif_results <- read.delim("data/signif_results_n.txt",header = TRUE,sep=",")
signif_results <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
View(signif_results)
signif_results <- read.delim("data/signif_results.txt",header = TRUE,sep=",")
choices = c(unique(signif_results$Phenotype),unique(signif_results$DO.Disease),unique(signif_results$OMIM.ID))
rsconnect::setAccountInfo(name='cell-phenotype', token='8DCF051412D37CA264752FD38047BBE2', secret='8Z/I+6drKSBp+3ItcirnlNhmytxLFMLPF7gIRol1')
library(rsconnect)
rsconnect::deployApp('C:\Users\Lusheng Li\Documents\Study\IC\Module6\Shiny\Cell-Disease')
wkdir()
getwd()
library(rsconnect)
rsconnect::deployApp('C:/Users/Lusheng Li/Documents/Study/IC/Module6/Shiny/Cell-Disease')
